{"version":3,"sources":["rating/rating.component.ts"],"names":[],"mappings":"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","file":"rating.component.js","sourcesContent":["import {\n    Component,\n    OnInit, Input, Output, HostListener,\n    Self, EventEmitter\n} from 'angular2/core';\nimport { NgFor, ControlValueAccessor, NgModel } from 'angular2/common';\n\n@Component({\n    selector: 'rating[ngModel]',\n    directives: [NgFor],\n    template: `\n    <span (mouseleave)=\"reset()\" (keydown)=\"onKeydown($event)\" tabindex=\"0\" role=\"slider\" aria-valuemin=\"0\" [attr.aria-valuemax]=\"range.length\" [attr.aria-valuenow]=\"value\">\n      <template ngFor #r [ngForOf]=\"range\" #index=\"index\">\n        <span class=\"sr-only\">({{ index < value ? '*' : ' ' }})</span>\n        <i (mouseenter)=\"enter(index + 1)\" (click)=\"rate(index + 1)\" class=\"glyphicon\" [ngClass]=\"index < value ? r.stateOn : r.stateOff\" [title]=\"r.title\" ></i>\n      </template>\n    </span>\n  `\n})\nexport class Rating implements ControlValueAccessor, OnInit {\n    @Input() private max:number;\n    @Input() private stateOn:string;\n    @Input() private stateOff:string;\n    @Input() private readonly:boolean;\n    @Input() private titles:Array<string>;\n    @Input() private ratingStates:Array<{stateOn:string, stateOff:string}>;\n\n    @Output() private onHover:EventEmitter<number> = new EventEmitter();\n    @Output() private onLeave:EventEmitter<number> = new EventEmitter();\n\n    private range:Array<any>;\n    private value:number;\n    private preValue:number;\n\n    @HostListener('keydown', ['$event'])\n    private onKeydown(event:KeyboardEvent) {\n        if ([37, 38, 39, 40].indexOf(event.which) === -1) {\n            return;\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n        let sign = event.which === 38 || event.which === 39 ? 1 : -1;\n        this.rate(this.value + sign);\n    }\n\n    constructor(@Self() public cd:NgModel) {\n        cd.valueAccessor = this;\n    }\n\n    ngOnInit() {\n        this.max = typeof this.max !== 'undefined' ? this.max : 5;\n        this.readonly = this.readonly === true;\n        this.stateOn = typeof this.stateOn !== 'undefined' ? this.stateOn : 'glyphicon-star';\n        this.stateOff = typeof this.stateOff !== 'undefined' ? this.stateOff : 'glyphicon-star-empty';\n        this.titles = typeof this.titles !== 'undefined' && this.titles.length > 0 ? this.titles : ['one', 'two', 'three', 'four', 'five'];\n        this.range = this.buildTemplateObjects(this.ratingStates, this.max);\n    }\n\n    writeValue(value:number) {\n        if (value % 1 !== value) {\n            this.value = Math.round(value);\n            this.preValue = value;\n            return;\n        }\n\n        this.preValue = value;\n        this.value = value;\n    }\n\n    private buildTemplateObjects(ratingStates:Array<any>, max:number) {\n        ratingStates = ratingStates || [];\n        let count = ratingStates.length || max;\n        let result:any[] = [];\n        for (let i = 0; i < count; i++) {\n            result.push(Object.assign({\n                index: i,\n                stateOn: this.stateOn,\n                stateOff: this.stateOff,\n                title: this.titles[i] || i + 1\n            }, ratingStates[i] || {}));\n        }\n        return result;\n    }\n\n    private rate(value:number) {\n        if (!this.readonly && value >= 0 && value <= this.range.length) {\n            this.writeValue(value);\n            this.cd.viewToModelUpdate(value);\n        }\n    }\n\n    private enter(value:number) {\n        if (!this.readonly) {\n            this.value = value;\n            this.onHover.emit(value);\n        }\n    }\n\n    private reset() {\n        this.value = this.preValue;\n        this.onLeave.emit(this.value);\n    }\n\n    onChange = (_:any) => {\n    };\n    onTouched = () => {\n    };\n\n    registerOnChange(fn:(_:any) => {}):void {\n        this.onChange = fn;\n    }\n\n    registerOnTouched(fn:() => {}):void {\n        this.onTouched = fn;\n    }\n}"]}